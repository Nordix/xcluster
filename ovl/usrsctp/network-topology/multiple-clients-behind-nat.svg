<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1143px" preserveAspectRatio="none" style="width:847px;height:1143px;" version="1.1" viewBox="0 0 847 1143" width="847px" zoomAndPan="magnify"><defs><filter height="300%" id="f1ae5buakvwp73" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="1121.1797" style="stroke: #A80036; stroke-width: 1.0;" width="447" x="19" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="222.5" y="16.0669">client</text><rect fill="#DDDDDD" height="1121.1797" style="stroke: #A80036; stroke-width: 1.0;" width="361" x="468" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="625.5" y="16.0669">server</text><rect fill="#FFFFFF" filter="url(#f1ae5buakvwp73)" height="1022.4531" style="stroke: #000000; stroke-width: 2.0;" width="822" x="13" y="91.7266"/><rect fill="#FFFFFF" height="73.0703" style="stroke: none; stroke-width: 1.0;" width="822" x="13" y="1041.1094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="56" x2="56" y1="74.7266" y2="1131.1797"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="132" x2="132" y1="74.7266" y2="1131.1797"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="299" x2="299" y1="74.7266" y2="1131.1797"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="411" x2="411" y1="74.7266" y2="1131.1797"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="532" x2="532" y1="74.7266" y2="1131.1797"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="662" x2="662" y1="74.7266" y2="1131.1797"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="794" x2="794" y1="74.7266" y2="1131.1797"/><rect fill="#FEFECE" filter="url(#f1ae5buakvwp73)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="62" x="23" y="39.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="30" y="59.4248">Client1</text><rect fill="#FEFECE" filter="url(#f1ae5buakvwp73)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="62" x="99" y="39.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="106" y="59.4248">Client2</text><rect fill="#FEFECE" filter="url(#f1ae5buakvwp73)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="248" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="281" y="43.1279">eth1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="255" y="59.4248">192.168.1.2</text><rect fill="#FEFECE" filter="url(#f1ae5buakvwp73)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="360" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="393" y="43.1279">eth2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="367" y="59.4248">192.168.2.2</text><rect fill="#FEFECE" filter="url(#f1ae5buakvwp73)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="116" x="472" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="514" y="43.1279">eth1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="102" x="479" y="59.4248">192.168.3.221</text><rect fill="#FEFECE" filter="url(#f1ae5buakvwp73)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="116" x="602" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="644" y="43.1279">eth2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="102" x="609" y="59.4248">192.168.4.221</text><rect fill="#FEFECE" filter="url(#f1ae5buakvwp73)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="763" y="39.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="770" y="59.4248">Server</text><path d="M13,91.7266 L77,91.7266 L77,98.7266 L67,108.7266 L13,108.7266 L13,91.7266 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1022.4531" style="stroke: #000000; stroke-width: 2.0;" width="822" x="13" y="91.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="28" y="104.7935">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="113" x="92" y="103.937">[Successful case]</text><polygon fill="#A80036" points="287,125.9922,297,129.9922,287,133.9922,291,129.9922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="56" x2="293" y1="129.9922" y2="129.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="63" y="124.9263">"INIT(11.2.0.x:7003)"</text><polygon fill="#A80036" points="520,155.125,530,159.125,520,163.125,524,159.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="299" x2="526" y1="159.125" y2="159.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="306" y="154.0591">"INIT(192.168.1.2:7003)"</text><polygon fill="#A80036" points="782,184.2578,792,188.2578,782,192.2578,786,188.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="532" x2="788" y1="188.2578" y2="188.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="539" y="183.1919">INIT</text><polygon fill="#A80036" points="543,213.3906,533,217.3906,543,221.3906,539,217.3906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="537" x2="793" y1="217.3906" y2="217.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="549" y="212.3247">"INIT_ACK(192.168.3.221:7003)"</text><polygon fill="#A80036" points="310,242.5234,300,246.5234,310,250.5234,306,246.5234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="304" x2="531" y1="246.5234" y2="246.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="316" y="241.4575">"INIT_ACK(192.168.3.221:7003)"</text><polygon fill="#A80036" points="67,271.6563,57,275.6563,67,279.6563,63,275.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="61" x2="298" y1="275.6563" y2="275.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="73" y="270.5903">INIT_ACK</text><polygon fill="#A80036" points="287,300.7891,297,304.7891,287,308.7891,291,304.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="56" x2="293" y1="304.7891" y2="304.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="63" y="299.7231">COOKIE_ECHO</text><polygon fill="#A80036" points="520,329.9219,530,333.9219,520,337.9219,524,333.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="299" x2="526" y1="333.9219" y2="333.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="306" y="328.856">COOKIE_ECHO</text><polygon fill="#A80036" points="782,359.0547,792,363.0547,782,367.0547,786,363.0547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="532" x2="788" y1="363.0547" y2="363.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="539" y="357.9888">COOKIE_ECHO</text><polygon fill="#A80036" points="543,388.1875,533,392.1875,543,396.1875,539,392.1875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="537" x2="793" y1="392.1875" y2="392.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="549" y="387.1216">COOKIE_ACK</text><polygon fill="#A80036" points="310,417.3203,300,421.3203,310,425.3203,306,421.3203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="304" x2="531" y1="421.3203" y2="421.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="316" y="416.2544">COOKIE_ACK</text><polygon fill="#A80036" points="67,446.4531,57,450.4531,67,454.4531,63,450.4531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="61" x2="298" y1="450.4531" y2="450.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="73" y="445.3872">COOKIE_ACK</text><polygon fill="#A80036" points="399,475.5859,409,479.5859,399,483.5859,403,479.5859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="56" x2="405" y1="479.5859" y2="479.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="63" y="474.52">"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="line-through" textLength="48" x="68" y="474.52">INIT (RJ)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="116" y="474.52">"</text><polygon fill="#A80036" points="67,504.7188,57,508.7188,67,512.7188,63,508.7188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="61" x2="410" y1="508.7188" y2="508.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="73" y="503.6528">"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="line-through" textLength="101" x="78" y="503.6528">INIT_ACK (M bit)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="179" y="503.6528">"</text><polygon fill="#A80036" points="399,533.8516,409,537.8516,399,541.8516,403,537.8516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="56" x2="405" y1="537.8516" y2="537.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="63" y="532.7856">"ASCONF(192.168.4.221)"</text><polygon fill="#A80036" points="650,562.9844,660,566.9844,650,570.9844,654,566.9844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="411" x2="656" y1="566.9844" y2="566.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="418" y="561.9185">ASCONF</text><polygon fill="#A80036" points="782,592.1172,792,596.1172,782,600.1172,786,596.1172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="662" x2="788" y1="596.1172" y2="596.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="669" y="591.0513">ASCONF</text><polygon fill="#A80036" points="673,621.25,663,625.25,673,629.25,669,625.25" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="667" x2="793" y1="625.25" y2="625.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="679" y="620.1841">ASCONF_ACK</text><polygon fill="#A80036" points="422,650.3828,412,654.3828,422,658.3828,418,654.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="416" x2="661" y1="654.3828" y2="654.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="428" y="649.3169">ASCONF_ACK</text><polygon fill="#A80036" points="67,679.5156,57,683.5156,67,687.5156,63,683.5156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="61" x2="410" y1="683.5156" y2="683.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="73" y="678.4497">ASCONF_ACK</text><polygon fill="#A80036" points="287,708.6484,297,712.6484,287,716.6484,291,712.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="56" x2="293" y1="712.6484" y2="712.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="63" y="707.5825">DATA</text><polygon fill="#A80036" points="520,737.7813,530,741.7813,520,745.7813,524,741.7813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="299" x2="526" y1="741.7813" y2="741.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="306" y="736.7153">DATA</text><polygon fill="#A80036" points="782,766.9141,792,770.9141,782,774.9141,786,770.9141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="532" x2="788" y1="770.9141" y2="770.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="539" y="765.8481">DATA</text><polygon fill="#A80036" points="543,796.0469,533,800.0469,543,804.0469,539,800.0469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="537" x2="793" y1="800.0469" y2="800.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="549" y="794.981">SACK</text><polygon fill="#A80036" points="310,825.1797,300,829.1797,310,833.1797,306,829.1797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="304" x2="531" y1="829.1797" y2="829.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="316" y="824.1138">SACK</text><polygon fill="#A80036" points="67,854.3125,57,858.3125,67,862.3125,63,858.3125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="61" x2="298" y1="858.3125" y2="858.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="73" y="853.2466">SACK</text><polygon fill="#A80036" points="673,883.4453,663,887.4453,673,891.4453,669,887.4453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="667" x2="793" y1="887.4453" y2="887.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="679" y="882.3794">HEARTBEAT</text><polygon fill="#A80036" points="422,912.5781,412,916.5781,422,920.5781,418,916.5781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="416" x2="661" y1="916.5781" y2="916.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="428" y="911.5122">HEARTBEAT</text><polygon fill="#A80036" points="67,941.7109,57,945.7109,67,949.7109,63,945.7109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="61" x2="410" y1="945.7109" y2="945.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="73" y="940.645">HEARTBEAT</text><polygon fill="#A80036" points="399,970.8438,409,974.8438,399,978.8438,403,974.8438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="56" x2="405" y1="974.8438" y2="974.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="63" y="969.7778">HEARTBEAT_ACK</text><polygon fill="#A80036" points="650,999.9766,660,1003.9766,650,1007.9766,654,1003.9766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="411" x2="656" y1="1003.9766" y2="1003.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="418" y="998.9106">HEARTBEAT_ACK</text><polygon fill="#A80036" points="782,1029.1094,792,1033.1094,782,1037.1094,786,1033.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="662" x2="788" y1="1033.1094" y2="1033.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="669" y="1028.0435">HEARTBEAT_ACK</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="835" y1="1042.1094" y2="1042.1094"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="94" x="18" y="1052.3198">[Port collision]</text><polygon fill="#A80036" points="287,1073.0469,297,1077.0469,287,1081.0469,291,1077.0469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="132" x2="293" y1="1077.0469" y2="1077.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="139" y="1071.981">"INIT(11.2.0.x:7003)"</text><polygon fill="#A80036" points="143,1102.1797,133,1106.1797,143,1110.1797,139,1106.1797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="137" x2="298" y1="1106.1797" y2="1106.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="149" y="1101.1138">"ABORT(port collision)"</text><!--
@startuml multiple-clients-behind-nat
hide footbox
box "client"
participant "Client1"
participant "Client2"
participant "eth1\n192.168.1.2" as c1
participant "eth2\n192.168.2.2" as c2
end box
box "server"
participant "eth1\n192.168.3.221" as s1
participant "eth2\n192.168.4.221" as s2
participant "Server"
end box

alt Successful case

Client1 -> c1 : "INIT(11.2.0.x:7003)"
c1 -> s1 : "INIT(192.168.1.2:7003)"
s1 -> Server : INIT

Server -> s1 : "INIT_ACK(192.168.3.221:7003)"
s1 -> c1 : "INIT_ACK(192.168.3.221:7003)"
c1 -> Client1 : INIT_ACK

Client1 -> c1 : COOKIE_ECHO
c1 -> s1 : COOKIE_ECHO
s1 -> Server : COOKIE_ECHO

Server -> s1 : COOKIE_ACK
s1 -> c1 : COOKIE_ACK
c1 -> Client1 : COOKIE_ACK

Client1 -> c2 : "- -INIT (RJ)- -"
c2 -> Client1 : "- -INIT_ACK (M bit)- -"

Client1 -> c2 : "ASCONF(192.168.4.221)"
c2 -> s2 : ASCONF
s2 -> Server : ASCONF

Server -> s2 : ASCONF_ACK
s2 -> c2 : ASCONF_ACK
c2 -> Client1: ASCONF_ACK

Client1 -> c1 : DATA
c1 -> s1 : DATA
s1 -> Server : DATA
Server -> s1 : SACK
s1 -> c1 : SACK
c1 -> Client1 : SACK

Server -> s2 : HEARTBEAT
s2 -> c2 : HEARTBEAT
c2 -> Client1 : HEARTBEAT
Client1 -> c2 : HEARTBEAT_ACK
c2 -> s2 : HEARTBEAT_ACK
s2 -> Server : HEARTBEAT_ACK

else Port collision
Client2 -> c1 : "INIT(11.2.0.x:7003)"
c1 -> Client2 : "ABORT(port collision)"

end
@enduml

PlantUML version 1.2018.13(Mon Nov 26 18:11:51 CET 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.14.1+1-Ubuntu-0ubuntu1.20.04
Operating System: Linux
OS Version: 5.10.16.3-microsoft-standard-WSL2
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>